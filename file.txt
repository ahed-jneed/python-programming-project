# Import Libraries
library(dplyr)
library(readr)

# Read the Datasets
dataset1 <- read_delim("path_to_your_first_dataset.txt", delim = "|")
dataset2 <- read_delim("path_to_your_second_dataset.txt", delim = "|")

# Column Name Translation
column_mapping <- c("GermanName1" = "BSEGName1", "GermanName2" = "BSEGName2")
dataset1 <- dataset1 %>% rename_with(~column_mapping[.x], names(dataset1))

# Aligning Columns
common_columns <- intersect(names(dataset1), names(dataset2))
dataset1 <- dataset1 %>% select(all_of(common_columns))
dataset2 <- dataset2 %>% select(all_of(common_columns))

# Appending the Datasets
combined_dataset <- rbind(dataset1, dataset2)

# Save the Combined Dataset:
write_delim(combined_dataset, "combined_dataset.txt", delim = "|")
